//https://github.com/psyipm/jquery-locationpicker-plugin
function FullScreenControl(e){var t=document.createElement("div");t.className="fullScreen";t.index=1;t.style.padding="5px";var n=document.createElement("div");n.style.backgroundColor="white";n.style.borderStyle="solid";n.style.borderWidth="1px";n.style.borderColor="#717b87";n.style.cursor="pointer";n.style.textAlign="center";n.style.boxShadow="rgba(0, 0, 0, 0.298039) 0px 1px 4px -1px";t.appendChild(n);var r=document.createElement("div");r.style.fontFamily="Roboto,Arial,sans-serif";r.style.fontSize="11px";r.style.fontWeight="400";r.style.paddingTop="1px";r.style.paddingBottom="1px";r.style.paddingLeft="6px";r.style.paddingRight="6px";r.innerHTML="<strong>Full Screen</strong>";n.appendChild(r);var i=document.getElementsByTagName("head")[0];var s=document.createElement("style");s.setAttribute("type","text/css");s.setAttribute("media","print");s.appendChild(document.createTextNode(".fullScreen { display: none;}"));i.appendChild(s);var o=false;var u;var a=e.getDiv();var f=a.style;if(a.runtimeStyle)f=a.runtimeStyle;var l=f.position;var c=f.width;var h=f.height;if(c=="")c=a.style.width;if(h=="")h=a.style.height;var p=f.top;var d=f.left;var v=f.zIndex;var m=document.body.style;if(document.body.runtimeStyle)m=document.body.runtimeStyle;var g=m.overflow;var y=function(){var t=e.getCenter();a.style.position="fixed";a.style.width="100%";a.style.height="100%";a.style.top="0";a.style.left="0";a.style.zIndex="1031";document.body.style.overflow="hidden";r.innerHTML="<strong>Exit full screen</strong>";o=true;google.maps.event.trigger(e,"resize");e.setCenter(t);u=setInterval(function(){if(a.style.position!="fixed"){a.style.position="fixed";google.maps.event.trigger(e,"resize")}},100)};var b=function(){var t=e.getCenter();if(l=="")a.style.position="relative";else a.style.position=l;a.style.width=c;a.style.height=h;a.style.top=p;a.style.left=d;a.style.zIndex=v;document.body.style.overflow=g;r.innerHTML="<strong>Full Screen</strong>";o=false;google.maps.event.trigger(e,"resize");e.setCenter(t);clearInterval(u)};google.maps.event.addDomListener(n,"click",function(){if(!o){y()}else{b()}});return t}(function(e){function t(e,t){var n=new google.maps.Map(e,t);n.controls[google.maps.ControlPosition.TOP_RIGHT].push(new FullScreenControl(n));var r=new google.maps.Marker({position:new google.maps.LatLng(54.19335,-3.92695),map:n,title:"Drag Me",draggable:t.draggable});return{map:n,marker:r,circle:null,location:r.position,radius:t.radius,locationName:t.locationName,settings:t.settings,domContainer:e,geodecoder:new google.maps.Geocoder}}function r(e){return i(e)!=undefined}function i(t){return e(t).data("locationpicker")}function s(e,t){if(!e)return;var r=n.locationFromLatLng(t.location);if(e.latitudeInput){e.latitudeInput.val(r.latitude)}if(e.longitudeInput){e.longitudeInput.val(r.longitude)}if(e.radiusInput){e.radiusInput.val(t.radius)}if(e.locationNameInput){e.locationNameInput.val(t.locationName)}}function o(t,r){if(t){if(t.radiusInput){t.radiusInput.on("change",function(){r.radius=e(this).val();n.setPosition(r,r.location,function(e){e.settings.onchanged.apply(r.domContainer,[n.locationFromLatLng(e.location),e.radius,false])})})}if(t.locationNameInput&&r.settings.enableAutocomplete){r.autocomplete=new google.maps.places.Autocomplete(t.locationNameInput.get(0));google.maps.event.addListener(r.autocomplete,"place_changed",function(){var e=r.autocomplete.getPlace();if(!e.geometry){r.settings.onlocationnotfound(e.name);return}n.setPosition(r,e.geometry.location,function(e){s(t,e);e.settings.onchanged.apply(r.domContainer,[n.locationFromLatLng(e.location),e.radius,false])})})}if(t.latitudeInput){t.latitudeInput.on("change",function(){n.setPosition(r,new google.maps.LatLng(e(this).val(),r.location.lng()),function(e){e.settings.onchanged.apply(r.domContainer,[n.locationFromLatLng(e.location),e.radius,false])})})}if(t.longitudeInput){t.longitudeInput.on("change",function(){n.setPosition(r,new google.maps.LatLng(r.location.lat(),e(this).val()),function(e){e.settings.onchanged.apply(r.domContainer,[n.locationFromLatLng(e.location),e.radius,false])})})}}}var n={drawCircle:function(t,n,r,i){if(t.circle!=null){t.circle.setMap(null)}if(r>0){r*=1;i=e.extend({strokeColor:"#0000FF",strokeOpacity:.35,strokeWeight:2,fillColor:"#0000FF",fillOpacity:.2},i);i.map=t.map;i.radius=r;i.center=n;t.circle=new google.maps.Circle(i);return t.circle}return null},setPosition:function(e,t,n){e.location=t;e.marker.setPosition(t);e.map.panTo(t);this.drawCircle(e,t,e.radius,{});if(e.settings.enableReverseGeocode){e.geodecoder.geocode({latLng:e.location},function(t,r){if(r==google.maps.GeocoderStatus.OK&&t.length>0){e.locationName=t[0].formatted_address}if(n){n.call(this,e)}})}else{if(n){n.call(this,e)}}},locationFromLatLng:function(e){return{latitude:e.lat(),longitude:e.lng()}}};e.fn.locationpicker=function(u,a){if(typeof u=="string"){var f=this.get(0);if(!r(f))return;var l=i(f);switch(u){case"location":if(a==undefined){var c=n.locationFromLatLng(l.location);c.radius=l.radius;c.name=l.locationName;return c}else{if(a.radius){l.radius=a.radius}n.setPosition(l,new google.maps.LatLng(a.latitude,a.longitude),function(e){s(e.settings.inputBinding,e)})}break;case"subscribe":if(a==undefined){return null}else{var h=a.event;var p=a.callback;if(!h||!p){console.error('LocationPicker: Invalid arguments for method "subscribe"');return null}google.maps.event.addListener(l.map,h,p)}break;case"map":if(a==undefined){return{map:l.map,marker:l.marker}}else{return null}}return null}return this.each(function(){var i=e(this);if(r(this))return;var a=e.extend({},e.fn.locationpicker.defaults,u);console.log(a);var f=new t(this,{zoom:a.zoom,center:new google.maps.LatLng(a.location.latitude,a.location.longitude),mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControl:false,disableDoubleClickZoom:false,scrollwheel:a.scrollwheel,streetViewControl:a.streetViewControl,radius:a.radius,locationName:a.locationName,settings:a,draggable:a.draggable});i.data("locationpicker",f);google.maps.event.addListener(f.marker,"dragend",function(e){n.setPosition(f,f.marker.position,function(e){var t=n.locationFromLatLng(f.location);e.settings.onchanged.apply(f.domContainer,[t,e.radius,true]);s(f.settings.inputBinding,f)})});n.setPosition(f,new google.maps.LatLng(a.location.latitude,a.location.longitude),function(e){s(a.inputBinding,f);e.settings.oninitialized(i)});o(a.inputBinding,f)})};e.fn.locationpicker.defaults={location:{latitude:40.7324319,longitude:-73.82480799999996},locationName:"",radius:500,zoom:15,scrollwheel:true,inputBinding:{latitudeInput:null,longitudeInput:null,radiusInput:null,locationNameInput:null},enableAutocomplete:false,enableReverseGeocode:true,draggable:true,onchanged:function(e,t,n){},onlocationnotfound:function(e){},oninitialized:function(e){}}})(jQuery)
